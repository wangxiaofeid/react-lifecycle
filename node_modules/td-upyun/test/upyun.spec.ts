import { Client, Service } from '../src/index';
import * as fs from 'fs';
import * as path from 'path';

const service = new Service('portal-static', 'portalstatic', 'KdVVcDCbr9e9Ho42Vgt+HXSe', 'http://prelude:5ea3Vp@192.168.74.209:3128');

describe('test upyun', () => {
  const client = new Client(service);
  it('test listDir', done => {
    client.listDir('/static-public').then(res => {
      expect(res['files']).toBeDefined();
      expect(res['files'].length).toBeGreaterThanOrEqual(0);
      expect(res['next']).toBeDefined();
      done();
    });
  });

  it('test putFile', done => {
    client.putFile('/static-public/test/test.js', fs.createReadStream(path.resolve(__dirname, 'test.js')))
      .then(res => {
        expect(res).toBeTruthy();
        done();
      });
  });

  it('test deleteFile', done => {
    client.deleteFile('/static-public/test/test.js')
      .then(res => {
        expect(res).toBeTruthy();
        done();
      });
  });

  it('test deleteDir', done => {
    client.deleteDir('/static-public/test')
      .then(res => {
        expect(res).toBeTruthy();
        done();
      });
  });
});